# 2025-10-19 Devlog (Wave 1 Day 5)

## Highlights
- Hardened the Postgres restore harness to boot the kernel with a shared command log and assert `fire`/`settle` emissions after restart (HK-PERSIST-02).
- Documented how to inspect `timer_command_log` locally so contributors can validate restart flows without digging into SQLx internals (DX-ENV-09).
- Kept persistence coverage green while lining up the next OTEL instrumentation pass for command log appends (HK-OBS-04).

## Stream Updates
### Control Plane (CP)
- Yesterday: Tracking kernel restart coverage to guarantee REST responses stay aligned with durable state.
- Today: No code changes; confirmed the kernel continues to settle timers before emitting follower redirects (CP-POLICY-09).
- Risks / Blockers: Awaiting OTEL spans from the kernel command log before surfacing richer retry hints via the gateway.
- Telemetry Links: _(pending once OTEL wiring lands for command log events)._ 

### Horology Kernel (HK)
- Yesterday: Restore test proved timers survive process restarts but skipped command log validation.
- Today: Wired the restart integration test to use `PostgresCommandLog`, asserted `fire` and `settle` rows appear, and left scaffolding for upcoming OTEL spans (HK-PERSIST-02).
- Risks / Blockers: Need to export the command log appends through OTEL before CI can enforce the restart suite in clustered mode (HK-OBS-04).
- Telemetry Links: `cargo test --manifest-path services/horology-kernel/Cargo.toml` (local run with Postgres).

### Execution Mesh (EM)
- Yesterday: Monitoring kernel persistence outcomes for downstream action orchestration.
- Today: No changes; waiting for the kernel to expose command log traces so the orchestrator can correlate timer events (EM-BUS-05).
- Risks / Blockers: Without OTEL spans on command log entries, DLQ replay tooling lacks trace context.
- Telemetry Links: _(pending)._ 

### Developer Experience (DX)
- Yesterday: Updated environment docs with `TEST_DATABASE_URL` guidance.
- Today: Added step-by-step instructions for checking `timer_command_log` so new contributors can validate restart behaviour quickly (DX-ENV-09).
- Risks / Blockers: Devcontainer bootstrap still needs to pre-seed the `TEST_DATABASE_URL` variable.
- Telemetry Links: See `cargo test` output referenced above.

### Governance
- Yesterday: Tracking need for persisted election audit trails.
- Today: Logged that command log OTEL spans must be in place before governance can consume restart telemetry (GOV-AUDIT-04).
- Risks / Blockers: Audit automation still depends on instrumented command log events.
- Telemetry Links: _(pending)._ 

## Testing Summary
- âœ… command `cargo test --manifest-path services/horology-kernel/Cargo.toml`

## Decisions & Follow-ups
- Follow-up: Add OTEL spans to command log appends and propagate trace IDs into the restart harness (owner: HK lead, due 2025-10-22).
- Follow-up: Automate devcontainer `.env` hydration for `TEST_DATABASE_URL` so integration tests run without manual exports (owner: DX lead, due 2025-10-24).
- Decision: Treat command log persistence as part of the restart acceptance criteria going forward (owner: HK lead, logged 2025-10-19).
