# 2025-10-21 Devlog (Wave 1 Day 7)

## Highlights
- Wrapped the Postgres-backed raft adapter and coordinator in OTEL spans so leadership votes, log replication, and state snapshots are observable end-to-end (HK-RAFT-09).
- Documented how to tail the OTEL collector for the new `horology.kernel.raft.*` span family, keeping Wave 1 telemetry guidance current (DX-ENV-11).
- Maintained the Wave 1 persistence suite green after instrumentation changes (HK-TEST-05).

## Stream Updates
### Control Plane (CP)
- Yesterday: Monitoring raft-backed leader handles while waiting on observability plumbing.
- Today: Coordinated with kernel observability to confirm the gateway will receive span metadata for leadership transitions (CP-OBS-04).
- Risks / Blockers: Need to enrich gateway metrics once span attributes are finalized.
- Telemetry Links: _(pending gateway span ingestion hookup)._ 

### Horology Kernel (HK)
- Yesterday: Landed the Postgres-backed raft storage adapter with persistence round-trip coverage.
- Today: Added OTEL spans across vote persistence, log mutations, purge watermarks, and snapshot installs, plus coordinator spans around `kernel_raft_state` updates (HK-RAFT-09).
- Risks / Blockers: Chaos drills against the adapter (DB outage, jitter) still outstanding before CI promotion.
- Telemetry Links: `cargo test --manifest-path services/horology-kernel/Cargo.toml --tests`.

### Execution Mesh (EM)
- Yesterday: Waiting for leadership observability to correlate orchestrator decisions.
- Today: Validated that new spans include leader node/term attributes needed for DLQ replay audits (EM-OBS-06).
- Risks / Blockers: Requires Tempo dashboards wired to the new span names.
- Telemetry Links: _(pending Tempo dashboard sync)._ 

### Developer Experience (DX)
- Yesterday: Documented raft inspection queries and migration steps.
- Today: Added instructions for tailing the OTEL collector and filtering for raft spans so contributors can confirm trace output locally (DX-ENV-11).
- Risks / Blockers: Devcontainer still needs automatic Postgres credentials for `TEST_DATABASE_URL` export.
- Telemetry Links: `cargo fmt --manifest-path services/horology-kernel/Cargo.toml`.

### Governance
- Yesterday: Tracking need for durable leadership audit trails.
- Today: Confirmed that raft span instrumentation captures vote/term transitions required for audit ingestion (GOV-AUDIT-05).
- Risks / Blockers: Governance dashboards must subscribe to the new span namespace before launch.
- Telemetry Links: `docker logs minoots-otel-collector | grep "horology.kernel.raft"`.

## Testing Summary
- ✅ command `cargo fmt --manifest-path services/horology-kernel/Cargo.toml`
- ✅ command `cargo test --manifest-path services/horology-kernel/Cargo.toml --tests`

## Decisions & Follow-ups
- Decision: Adopt `horology.kernel.raft.*` as the canonical span prefix for raft persistence and leadership events (owner: HK observability, logged 2025-10-21).
- Follow-up: Add chaos coverage for Postgres outages and heartbeat jitter before enabling clustered CI gating (owner: HK reliability, due 2025-10-25).
- Follow-up: Wire gateway metrics dashboards to the new span attributes once Tempo ingestion is verified (owner: CP observability, due 2025-10-27).
