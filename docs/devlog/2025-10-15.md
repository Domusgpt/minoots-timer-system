# 2025-10-15 Devlog (Wave 0 Day 0)

## Highlights
- Bootstrap infrastructure delivered (Postgres + JetStream + OTEL) with automated script and documentation.
- Control plane now persists timers in Postgres with OTEL instrumentation and request tracing headers.
- Horology kernel restored from persistence via SQLx-backed store and now toggles Postgres via `KERNEL_STORE`/`KERNEL_DATABASE_URL`.
- JetStream orchestrator exposes DLQ replay CLI for inspection/replay alongside durable consumer handling.
- Repo-wide CI added with devlog enforcement and infra smoke tests to lock Wave 0 guardrails.

## Stream Updates
### Control Plane (CP)
- Yesterday: Legacy Express API without durable repository.
- Today: Implemented Postgres timer repository + migrations, wired OTEL Node SDK, and added structured request logging.
- Risks / Blockers: Need follow-up ADR on ORM/tooling for schema evolution (manual SQL vs. Drizzle).
- Telemetry Links: Collector stdout (`docker logs minoots-otel-collector`) after running `./scripts/bootstrap-dev.sh`.

### Horology Kernel (HK)
- Yesterday: Tokio scheduler persisted only in-memory.
- Today: Added persistence trait, SQLx Postgres adapter, restore-on-start logic, tests covering restart hydration, and env-based store selection in the runtime binary.
- Risks / Blockers: Need configuration doc for multi-database support and telemetry on store selection failures.
- Telemetry Links: Kernel logs (tracing) once OTEL exporter configured in follow-up.

### Execution Mesh (EM)
- Yesterday: JetStream consumption plan only.
- Today: Upgraded NATS source to JetStream durable consumer with DLQ publisher; added provisioning script and DLQ replay/inspect CLI.
- Risks / Blockers: Need automated integration test harness against JetStream (requires container orchestration work).
- Telemetry Links: `nats stream view MINOOTS_TIMER` after bootstrap.

### Developer Experience (DX)
- Yesterday: No shared bootstrap story.
- Today: Delivered `.env.example`, docker-compose, OTEL collector config, and `docs/devx/LOCAL_ENVIRONMENT.md` walkthrough plus CI (devlog enforcement + infra smoke) and DLQ utility docs.
- Risks / Blockers: Update multi-service e2e harness to run under GitHub Actions once new infra scripts mature.
- Telemetry Links: Bootstrap script output.

### Governance
- Yesterday: Planning-only.
- Today: No direct changes; telemetry groundwork enables future audit ledger instrumentation.
- Risks / Blockers: Need signed envelope implementation in Wave 1.
- Telemetry Links: _(pending)_

## Testing Summary
- ✅ command `npm test` (apps/control-plane)
- ✅ command `cargo test --manifest-path services/horology-kernel/Cargo.toml`
- ✅ command `npm run build` (services/action-orchestrator)
- ⚠️ command `npm run test:e2e` (blocked until multi-service harness wired to new infra)

## Decisions & Follow-ups
- Decision: Adopt devlog/test charter as default repo policy (owner: DX lead, due: 2025-10-17).
- Follow-up: Draft ADR on persistence substrate trade-offs (owner: HK lead, due: 2025-10-20).
- Follow-up: Prepare GitHub Actions plan for devlog enforcement (**completed via CI workflow**, owner: DX).
- Follow-up: Add kernel runtime flag/env selection for Postgres store (**completed via env wiring**, owner: HK).
- Follow-up: Author DLQ replay tooling spec (**completed with replay CLI delivery**, owner: EM).
- New Follow-up: Stand up JetStream integration tests exercising DLQ replay flow (owner: EM, due: 2025-10-28).
- New Follow-up: Document multi-store telemetry expectations for kernel persistence (owner: HK, due: 2025-10-25).
