# 2025-10-22 Devlog (Wave 1 Day 8)

## Highlights
- Landed HMAC-signed timer event envelopes in the horology kernel and action orchestrator so downstream consumers can reject spoofed events (HK-EVT-10).
- Updated the local environment guide and `.env.example` with the shared `EVENT_ENVELOPE_SECRET` configuration required for Wave 1 teams (DX-ENV-12).
- Exercised the persistence and orchestrator suites to validate signature generation, verification, and DLQ handling after the envelope change (HK-TEST-06 / EM-TEST-04).

## Stream Updates
### Control Plane (CP)
- Yesterday: Coordinating with kernel team on event envelope schema changes.
- Today: Confirmed the gRPC gateway can proxy the new `TimerEventEnvelope` message without additional transforms while retaining metadata headers (CP-OBS-04).
- Risks / Blockers: Need to surface envelope signature/version details in audit responses once the policy wall exposes timer event logs.
- Telemetry Links: `_pending gateway audit integration._`

### Horology Kernel (HK)
- Yesterday: Finished wrapping Postgres raft persistence with OTEL spans.
- Today: Added canonical JSON signing, broadcast channel changes, and gRPC stream updates for the new `EventEnvelope`, plus verification helpers used in tests (HK-EVT-10).
- Risks / Blockers: Need to wire JetStream publishers to emit envelopes so non-orchestrator consumers can verify signatures before Wave 1 freeze.
- Telemetry Links: `cargo test --manifest-path services/horology-kernel/Cargo.toml --tests`.

### Execution Mesh (EM)
- Yesterday: Awaiting signed envelope work to unblock DLQ auditing.
- Today: Updated event sources to parse envelope payloads, verify signatures for gRPC/JetStream/STDIN inputs, and dead-letter invalid events with structured errors (EM-SEC-07).
- Risks / Blockers: Configure Tempo dashboards to highlight signature verification failures for on-call runbooks.
- Telemetry Links: `npm test -- --passWithNoTests`.

### Developer Experience (DX)
- Yesterday: Documenting raft observability workflows.
- Today: Added envelope-secret setup instructions to the local environment guide and example env so contributors share the same signing configuration (DX-ENV-12).
- Risks / Blockers: Need devcontainer task to auto-generate a per-user secret for first-run bootstrap.
- Telemetry Links: `_docs update only_`.

### Governance
- Yesterday: Reviewing audit requirements for timer event authenticity.
- Today: Validated that signed envelopes provide the cryptographic traceability needed for audit ingestion and policy wall enforcement (GOV-AUDIT-06).
- Risks / Blockers: Coordinate with compliance to define rotation cadence and secure secret distribution beyond local env.
- Telemetry Links: `_pending governance dashboard update_`.

## Testing Summary
- ✅ command `cargo test --manifest-path services/horology-kernel/Cargo.toml --tests`
- ✅ command `npm test -- --passWithNoTests`

## Decisions & Follow-ups
- Decision: Standardize on `v1-hmac-sha256` envelopes backed by `EVENT_ENVELOPE_SECRET`, verified at every consumer entry point (owner: HK/EM leads, logged 2025-10-22).
- Follow-up: Extend JetStream publisher to emit envelopes once the policy wall begins streaming timer events (owner: HK platform, due 2025-10-25).
- Follow-up: Add secret-rotation guidance and tooling prior to Wave 1 exit review (owner: Governance, due 2025-10-28).
