# 2025-10-17 Devlog (Wave 1 Day 3)

## Highlights
- Replaced the placeholder Raft network with an HTTP-driven OpenRaft supervisor that exercises real RPC flows against local peers.
- Added a three-node integration test that proves leader election, shutdown, and failover succeed over HTTP using ephemeral ports.
- Captured the remaining work to persist cluster state and emit telemetry so Raft replication can graduate beyond the in-memory memstore.

## Stream Updates
### Control Plane (CP)
- Yesterday: Control plane surfaced follower 503s but still depended on the Postgres advisory-lock coordinator.
- Today: No code changes; coordinated with HK to consume the upcoming OpenRaft supervisor once the gRPC surface exposes the new leadership signals.
- Risks / Blockers: Requires gRPC stream updates once the OpenRaft leader handle is plumbed through (CP-POLICY-09).
- Telemetry Links: _(pending until kernel emits Raft leader metrics into OTEL)._ 

### Horology Kernel (HK)
- Yesterday: Postgres-backed leadership coordinator existed, but the OpenRaft supervisor still stubbed networking/storage.
- Today: Implemented `HttpRaftNetworkFactory` + Axum handlers, wired membership bootstrap, and added a three-node failover test using ephemeral ports.
- Risks / Blockers: Need to swap the MemStore adapter for Postgres-backed storage and surface metrics/traces for elections (HK-RAFT-05).
- Telemetry Links: `cargo test --test raft_supervisor -- --nocapture` for local validation of election + failover.

### Execution Mesh (EM)
- Yesterday: Monitoring kernel failover impacts on orchestrator subscriptions.
- Today: No direct changes; awaiting kernel event stream once OpenRaft emits durable events.
- Risks / Blockers: Must subscribe to the Raft event feed after persistence lands (EM-BUS-05).
- Telemetry Links: _(pending)._ 

### Developer Experience (DX)
- Yesterday: Local environment guide covered Postgres coordinator behaviour only.
- Today: Drafted notes for adding OpenRaft HTTP supervisor instructions once the CLI toggles are exposed.
- Risks / Blockers: Need to update `docs/devx/LOCAL_ENVIRONMENT.md` after the supervisor is behind a feature flag (DX-ENV-08).
- Telemetry Links: Snapshot `cargo test` output in devlog attachments for now.

### Governance
- Yesterday: Awaiting telemetry for audit trails on leadership changes.
- Today: Logged follow-up to capture Raft election events once observability spine is wired.
- Risks / Blockers: Governance automation depends on persisted election audit logs (GOV-AUDIT-04).
- Telemetry Links: _(pending)._ 

## Testing Summary
- âœ… command `cargo test --manifest-path services/horology-kernel/Cargo.toml`

## Decisions & Follow-ups
- Follow-up: Replace MemStore with Postgres-backed log/state machine to align with durability goals (owner: HK lead, due: 2025-10-24).
- Follow-up: Expose Raft supervisor toggles through the kernel CLI and document the workflow (owner: DX lead, due: 2025-10-22).
- Decision: Adopt HTTP-based OpenRaft networking for the kernel control plane, enabling gradual migration from the advisory-lock coordinator (owner: HK lead, logged 2025-10-17).
